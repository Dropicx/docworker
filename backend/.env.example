# ===========================================
# DocTranslator Environment Configuration
# ===========================================
#
# Copy this file to .env and configure with your values
# Never commit .env files to version control!
#
# Priority Order:
# 1. Environment variables (highest)
# 2. .env file
# 3. Defaults from app/core/config.py
#

# ===========================================
# Application Settings
# ===========================================

# Application name
APP_NAME=DocTranslator

# Environment: development, staging, production
ENVIRONMENT=development

# Enable debug mode (disable in production!)
DEBUG=false

# Server port
PORT=9122

# ===========================================
# Database Settings (REQUIRED)
# ===========================================

# PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
# Example (local): postgresql://postgres:postgres@localhost:5432/doctranslator
# Example (Railway): Automatically set by Railway
DATABASE_URL=postgresql://user:password@localhost:5432/doctranslator

# Connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT=30

# ===========================================
# Redis Settings (Optional - for Celery)
# ===========================================

# Redis connection string for Celery task queue
# Format: redis://host:port/db
# Example: redis://localhost:6379/0
# Leave empty if not using workers
REDIS_URL=

# Maximum Redis connections
REDIS_MAX_CONNECTIONS=50

# ===========================================
# OVH AI Endpoints (REQUIRED)
# ===========================================

# OVH AI Endpoints access token
# Get from: https://endpoints.ai.cloud.ovh.net/
OVH_AI_ENDPOINTS_ACCESS_TOKEN=your-token-here

# OVH AI base URL
OVH_AI_BASE_URL=https://oai.endpoints.kepler.ai.cloud.ovh.net/v1

# Main LLM model for processing
OVH_MAIN_MODEL=Meta-Llama-3_3-70B-Instruct

# Fast model for preprocessing tasks
OVH_PREPROCESSING_MODEL=Mistral-Nemo-Instruct-2407

# Model for translation tasks
OVH_TRANSLATION_MODEL=Meta-Llama-3_3-70B-Instruct

# Use only OVH AI endpoints (disable fallbacks)
USE_OVH_ONLY=true

# ===========================================
# OCR Configuration
# ===========================================

# Mistral OCR API key (primary OCR engine)
# Get from: https://console.mistral.ai/
MISTRAL_API_KEY=your-mistral-api-key

# External PaddleOCR service (fallback OCR engine)
# Deployed on Hetzner via terraform in external_deployment/hetzner_paddleocr
EXTERNAL_OCR_URL=https://ocr.yourdomain.com
EXTERNAL_API_KEY=your-paddleocr-api-key

# ===========================================
# External PII Service (SpaCy)
# ===========================================

# PRIMARY: Hetzner SpaCy PII service (production)
# Deployed on Hetzner via terraform in external_deployment/hetzner_pii
EXTERNAL_PII_URL=https://pii.yourdomain.com
EXTERNAL_PII_API_KEY=your-pii-api-key

# Enable external PII service (set to true after deploying Hetzner service)
USE_EXTERNAL_PII=true

# FALLBACK: Railway SpaCy PII service (backup, usually in sleep mode)
# Deploy pii_service/ to Railway as separate service, keep at 0 replicas
# Activate by setting replicas to 1 in Railway dashboard if Hetzner fails
FALLBACK_PII_URL=https://pii-fallback.railway.app
FALLBACK_PII_API_KEY=your-fallback-pii-api-key

# ===========================================
# Security Settings
# ===========================================

# Secret key for session encryption (generate random string)
# Generate with: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=your-secret-key-here

# Access code for settings UI
# Default: admin123 (CHANGE IN PRODUCTION!)
SETTINGS_ACCESS_CODE=admin123

# CORS allowed origins (comma-separated)
# Use * for development, specific origins in production
# Example: https://healthlingo.de,https://app.healthlingo.de
ALLOWED_ORIGINS=*

# Trusted host headers (comma-separated)
TRUSTED_HOSTS=*

# ===========================================
# File Processing Settings
# ===========================================

# Maximum upload file size in MB
MAX_FILE_SIZE_MB=50

# Allowed file extensions (comma-separated)
ALLOWED_FILE_TYPES=.pdf,.docx,.txt,.jpg,.jpeg,.png

# Temporary file storage directory
TEMP_DIR=/tmp

# ===========================================
# Feature Flags (Optional)
# ===========================================
# These can be overridden via environment variables
# Format: FEATURE_FLAG_{NAME}=true/false
#
# Available flags (see app/services/feature_flags.py):
# - FEATURE_FLAG_MULTI_FILE_PROCESSING_ENABLED
# - FEATURE_FLAG_ADVANCED_PRIVACY_FILTER_ENABLED
# - FEATURE_FLAG_PII_REMOVAL_ENABLED
# - FEATURE_FLAG_COST_TRACKING_ENABLED
# - FEATURE_FLAG_AI_LOGGING_ENABLED
# - FEATURE_FLAG_PARALLEL_STEP_EXECUTION_ENABLED
# - FEATURE_FLAG_DYNAMIC_BRANCHING_ENABLED
# - FEATURE_FLAG_STOP_CONDITIONS_ENABLED
# - FEATURE_FLAG_RETRY_ON_FAILURE_ENABLED

# Enable OCR text extraction
ENABLE_OCR=true

# Enable PII privacy filtering
ENABLE_PRIVACY_FILTER=true

# Enable multi-file batch processing
ENABLE_MULTI_FILE=true

# ===========================================
# AI Processing Settings
# ===========================================

# AI request timeout in seconds
AI_TIMEOUT_SECONDS=300

# Maximum AI request retries
AI_MAX_RETRIES=3

# Delay between AI requests in milliseconds
AI_REQUEST_DELAY_MS=100

# ===========================================
# Logging Settings
# ===========================================

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log message format
LOG_FORMAT=%(asctime)s | %(levelname)-8s | %(name)s | %(message)s

# ===========================================
# Railway Settings (Auto-configured)
# ===========================================

# Railway environment name (auto-set by Railway)
# RAILWAY_ENVIRONMENT=production

# Railway project ID (auto-set by Railway)
# RAILWAY_PROJECT_ID=your-project-id

# ===========================================
# Rate Limiting
# ===========================================

# API rate limit per minute
RATE_LIMIT_PER_MINUTE=60

# ===========================================
# Notes
# ===========================================
#
# Required Variables:
# - DATABASE_URL
# - OVH_AI_ENDPOINTS_ACCESS_TOKEN
#
# Recommended to Change in Production:
# - SECRET_KEY (generate random)
# - SETTINGS_ACCESS_CODE (change from default)
# - ALLOWED_ORIGINS (set specific domains)
# - TRUSTED_HOSTS (set specific domains)
# - DEBUG (set to false)
#
# Railway Auto-Configuration:
# - DATABASE_URL is automatically set by Railway PostgreSQL service
# - RAILWAY_ENVIRONMENT and RAILWAY_PROJECT_ID are set by Railway
#
# Feature Flags:
# - Can be controlled via environment variables (highest priority)
# - Can be controlled via database (medium priority via admin API)
# - Have defaults in config.py (lowest priority)
#
# For more information, see:
# - Configuration: docs/CONFIGURATION.md
# - Feature Flags: docs/FEATURE_FLAGS.md
# - Development: docs/DEVELOPMENT.md
#
